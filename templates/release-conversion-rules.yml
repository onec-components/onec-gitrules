spec:
  inputs:
    stage:
      default: "release"
    build_job_name:
      description: "Имя джобы сборки артефакта"
      default: "build-conversion-rules"
---
release-conversion-rules:
  stage: $[[ inputs.stage ]]
  image: registry.gitlab.com/gitlab-org/cli:latest
  script:
    - echo "Creating release $CI_COMMIT_TAG with asset $ASSET_NAME"
  rules:
    - if: '$CI_COMMIT_TAG'
  needs:
    - job: $[[ inputs.build_job_name ]]
      artifacts: true
  release:
    tag_name: $CI_COMMIT_TAG
    description: "Правила конвертации для версии $CI_COMMIT_TAG"
    assets:
      links:
        - name: "$ASSET_NAME"
          url: "$CI_PROJECT_URL/-/jobs/$BUILD_JOB_ID/artifacts/file/$ASSET_NAME"
          

  